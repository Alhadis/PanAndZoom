<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Pinch and zoom</title>
<style>
*{
	box-sizing: border-box;
	tab-size: 4;
}
html, body{
	margin: 0;
	padding: 0;
	background: #ccc;
	width: 100vw;
}
#map{
	touch-action: none;
	overflow: hidden;
	width: 32em;
	margin: 1em;
	background: #900;
	box-shadow: .1em .1em .35em rgba(0,0,0,.45);
	border: 1px solid #444;
}
	#map > img{
		width: 100%;
		display: block;
		transform: translate(0, 0);
		transform-origin: 0 0;
	}
	#viewer.zooming > img{
		transition: .3s ease transform;
	}
</style>
</head>


<body>

	<div id="map">
		<img src="world-map.svg" alt="World Map" />
	</div>
	
	<script type="module">
		import PanAndZoom from "../pan-and-zoom.mjs";
		
		const map = document.getElementById("map");
		const svg = map.firstElementChild;
		
		const paz = new PanAndZoom({
			update: () => {
				svg.style.transform = paz;
			}
		});
		paz.zoom = 2;
		map.addEventListener("transitionend", event => {
			if("transform" === event.propertyName){
				viewer.classList.remove("zooming");
			}
		});
		
		map.addEventListener("wheel", event => {
			paz.panX -= event.deltaX;
			paz.panY -= event.deltaY;
		}, {passive: true});
		
		map.addEventListener("dblclick", event => {
			const {offsetX, offsetY} = event;
			map.classList.add("zooming");
			paz.originX = offsetX;
			paz.originY = offsetY;
			paz.zoom += event.metaKey ? -1 : 1;
		});
	</script>

</body>
</html>
